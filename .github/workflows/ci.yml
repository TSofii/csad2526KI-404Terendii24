name: Cross-Platform CMake CI

on:
  push:
    branches: [ "main", "master", "develop", "feature/**" ]
  pull_request:
    branches: [ "main", "master", "develop" ]

jobs:
  cross_build:
    name: Build on ${{ matrix.os }}
    runs-on: ${{ matrix.os }}
    strategy:
      fail-fast: false
      matrix:
        os: [ubuntu-latest, windows-latest, macos-latest]

    steps:
    - name: Checkout code
      uses: actions/checkout@v4

    # Для Linux та macOS прописуємо команди вручну, бо у вас може не бути ci.sh
    - name: Configure, Build and Test (Linux/macOS)
      if: runner.os != 'Windows'
      run: |
        cmake -S . -B build
        cmake --build build
        cd build && ctest --output-on-failure

    # Для Windows запускаємо ваш ci.bat, як вимагає методичка
    - name: Configure, Build and Test (Windows)
      if: runner.os == 'Windows'
      run: .\ci.bat

    - name: Deploy
      run: echo "Deploy step placeholder"
